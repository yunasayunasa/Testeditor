# Odyssey Engine 改修タスクリスト

**最終更新**: 2025-11-26  
**プロジェクト**: iPad向け2D Unityクローン Webアプリ

## 🔴 P0 - 最優先タスク

### ✅ TASK-001: VSLエディタのCSS実装【最重要】

**ステータス**: 🔴 未着手  
**担当**: AI  
**優先度**: P0 - 最優先  
**見積**: 1-2時間

**目的**:
VSL（ビジュアルスクリプティング）エディタのノードマップを表示可能にする。現在、`style.css`にVSL関連のスタイルが完全に欠落しているため、イベントエディタモーダルを開いてもノード配置エリアが表示されない。

**実装内容**:

1. **モーダルレイアウト**
   - `#event-editor-overlay` - イベントエディタのオーバーレイ
   - `#vsl-canvas-wrapper` - キャンバスラッパー
   - `#vsl-canvas` - メインキャンバス
   - `#vsl-svg-layer` - 接続線描画用SVGレイヤー

2. **ノードスタイル**
   - `.vsl-node` - ノード本体（ドラッグ可能、影付き）
   - `.vsl-node-header` - ノードヘッダー（タイトル表示）
   - `.vsl-node-body` - ノード本体
   - `.vsl-node-pin` - 入力/出力ピン（クリック可能な円）
   - `.vsl-pins-container` - ピンコンテナ
   - `.vsl-pin-wrapper` - 個別ピンラッパー
   - `.pin-label` - ピンラベル

3. **パラメータ入力**
   - `.param-row` - パラメータ行
   - `.param-label` - パラメータラベル
   - `.param-input` - パラメータ入力欄

4. **ステートマシンエディタ**
   - `#sm-editor-overlay` - ステートマシンエディタモーダル
   - `.sm-vsl-canvas` - ステートマシンVSLキャンバス
   - `.sm-vsl-node-list` - ノードリスト
   - `#sm-states-panel` - ステート一覧パネル
   - `#sm-vsl-panel` - VSLパネル

5. **ツールバー**
   - `#vsl-toolbar` - VSLツールバー
   - `#vsl-trigger-editor` - トリガー選択エリア
   - `#vsl-tabs-container` - タブコンテナ
   - `#vsl-node-list` - 追加可能ノード一覧

**iPad対応要件**:

- ノードの最小サイズ: 120px幅
- ピンのタッチターゲット: 最小24px×24px
- ドラッグ時のフィードバック: `cursor: grabbing`, 半透明化
- スクロール可能なキャンバス

**確認方法**:

1. デバッグモードで起動（`?debug=true`）
2. シーン内のオブジェクトを選択
3. インスペクタから「イベントエディタを開く」ボタンをクリック
4. VSLキャンバスが表示されることを確認
5. ノードリストからノードをキャンバスに追加
6. ノードをドラッグして移動可能なことを確認
7. ピンをクリックして接続線を作成できることを確認

**依存関係**:

- なし（単独で実装可能）

**ブロック先**:

- TASK-002（VSL機能確認）
- TASK-003（イベントグラフ作成テスト）

---

### ✅ TASK-002: VSLエディタの動作確認

**ステータス**: 🔴 未着手  
**担当**: AI + ユーザー  
**優先度**: P0  
**見積**: 30分

**依存関係**:

- TASK-001完了後

**確認項目**:

1. [ ] モーダルが正しく開く
2. [ ] ノードリストが表示される
3. [ ] ノードをキャンバスに追加できる
4. [ ] ノードをドラッグして移動できる
5. [ ] ピンをクリックして接続を作成できる
6. [ ] 接続線（SVGパス）が正しく描画される
7. [ ] ノードパラメータを編集できる
8. [ ] 変更がオブジェクトデータに保存される
9. [ ] ステートマシンエディタも同様に機能する

**不具合発見時の対応**:

- コンソールエラーをログ出力
- 該当コンポーネントのJavaScriptを確認
- 必要に応じてTASK-002-FIX（追加タスク）を作成

---

### ✅ TASK-003: VSLエディタのサンプルイベント作成テスト

**ステータス**: 🔴 未着手  
**担当**: ユーザー  
**優先度**: P0  
**見積**: 15分

**依存関係**:

- TASK-002完了後

**テストシナリオ**:

1. プレイヤーオブジェクトにコイン取得イベントを追加
2. トリガー: `onOverlap_Start`
3. 対象グループ: `coin`
4. アクション:
   - `[eval exp="f.score = f.score + 100"]` - スコア加算
   - `[destroy target=other]` - コインを消す
   - `[play_se storage="coin_get"]` - 効果音再生

**成功基準**:

- イベントグラフが視覚的に構築できる
- ノード間の接続が論理的に正しい
- プレイモードでイベントが発火する

---

## 🟡 P1 - 高優先タスク

### ✅ TASK-101: Undo/Redoのデバッグ

**ステータス**: 🔴 未着手  
**担当**: AI  
**優先度**: P1  
**見積**: 1-2時間

**問題**:

- Undo/Redoボタンは表示されているが機能していない
- コマンドが記録されていない可能性

**調査項目**:

1. `EditorCommandManager.js`のコマンドスタック確認
2. `execute()`メソッドが呼ばれているか
3. UIボタンのイベントリスナー接続確認
4. オブジェクト移動時のコマンド記録タイミング

**実装アプローチ**:

1. コンソールログでデバッグ出力追加
2. コマンド記録のタイミングを修正
3. UIボタンの`disabled`属性の制御を修正

---

### ✅ TASK-102: アニメーションタブの修正

**ステータス**: 🔴 未着手  
**担当**: AI  
**優先度**: P1  
**見積**: 30分

**問題**:

- Animationタブをクリックしても反応しない
- タブ切り替えイベントリスナーが未実装の可能性

**実装内容**:

1. `EditorUI.js`のタブ切り替えロジックを確認
2. `#tab-animation`のイベントリスナーを追加
3. `#animation-view`の表示/非表示切り替えを実装

---

## 🟢 P2 - 中優先タスク

### ✅ TASK-201: アセットドラッグ&ドロップ機能

**ステータス**: 🔴 未着手  
**担当**: AI  
**優先度**: P2  
**見積**: 2-3時間

**機能**:

- プロジェクトパネルにファイルをドラッグ&ドロップしてアセットをインポート

**実装内容**:

1. ドロップゾーンの作成
2. `dragover`, `drop`イベントハンドラ実装
3. ファイル検証（画像/音声フォーマット）
4. アセット登録処理
5. サムネイル生成

---

### ✅ TASK-202: アセット追加ボタン

**ステータス**: 🔴 未着手  
**担当**: AI  
**優先度**: P2  
**見積**: 1時間

**機能**:

- 「+」ボタンクリックでファイル選択ダイアログを開く

**実装内容**:

1. `<input type="file">`要素の追加
2. ボタンクリックでファイル選択ダイアログを開く
3. TASK-201と同じアセット登録処理を共有

---

### ✅ TASK-203: UIツールチップの改善

**ステータス**: 🔴 未着手  
**担当**: AI  
**優先度**: P2  
**見積**: 1時間

**目的**:

- 各UI要素の機能をより詳しく説明するツールチップを追加

**対象**:

- ヒエラルキーパネルの機能
- インスペクタの各プロパティ
- アセットブラウザの操作方法

---

## ⚪ P3 - 低優先タスク

### ✅ TASK-301: エディタヘルプコンテンツの充実

**ステータス**: 🔴 未着手  
**担当**: AI  
**優先度**: P3  
**見積**: 2-3時間

**内容**:

- `manual.html`の内容をより詳細に
- スクリーンショット付きチュートリアル
- よくある質問（FAQ）

---

### ✅ TASK-302: GizmoManagerの整理（調査）

**ステータス**: 🔴 未着手  
**担当**: AI  
**優先度**: P3  
**見積**: 30分

**目的**:

- `src/editor/GizmoManager.js`と`src/plugins/GizmoManager.js`の重複を調査
- 2つの違いを明確化
- 必要に応じて統合

---

## 📊 進捗サマリー

| 優先度 | 総タスク数 | 完了 | 進行中 | 未着手 |
|--------|-----------|------|--------|--------|
| P0     | 3         | 0    | 0      | 3      |
| P1     | 2         | 0    | 0      | 2      |
| P2     | 3         | 0    | 0      | 3      |
| P3     | 2         | 0    | 0      | 2      |
| **合計** | **10**  | **0** | **0** | **10** |

---

## 🎯 次のアクション

### ユーザーへの確認事項（開始前に必須）

1. **VSLエディタの現在の挙動**
   - モーダルは開きますか？
   - 開くが中身が見えないのですか？
   - それとも開かないのですか？
2. **テスト環境**
   - ブラウザ: Chrome/Safari/Firefox?
   - デバイス: PC/iPad?
3. **コンソールエラー**
   - F12で開発者ツールを開いてエラーが出ていますか？

### 開始可能なタスク

- ✅ **TASK-001** - ユーザー確認なしで開始可能（CSSの追加のみ）

### 確認後に開始するタスク

- TASK-002以降 - ユーザーからの回答後に適切な順序で進行

---

**注意**: このタスクリストは、ユーザーからのフィードバックに応じて随時更新されます。
